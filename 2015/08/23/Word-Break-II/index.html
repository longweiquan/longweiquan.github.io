<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> LeetCode - Word Break II · Dragon Egg</title><meta name="description" content="LeetCode - Word Break II - Weiquan LONG"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://longweiquan.github.com/atom.xml" title="Dragon Egg"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/longweiquan" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">LeetCode - Word Break II</h1><div class="post-info">Aug 23, 2015</div><div class="post-content"><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote><p>Given a string s and a dictionary of words dict, add spaces in s to construct a sentence where each word 
is a valid dictionary word. Return all such possible sentences.</p>
<footer><strong>@LeetCode</strong><cite><a href="https://leetcode.com/problems/word-break-ii/" target="_blank" rel="external">leetcode.com/problems/word-break-ii</a></cite></footer></blockquote>
<h2 id="Analyse"><a href="#Analyse" class="headerlink" title="Analyse"></a>Analyse</h2><p>It’s an upgrade version of <a href="/2015/08/23/Word-Break/" title="LeetCode - Word Break">LeetCode - Word Break</a>. Instead of boolean result, the second version ask for all possible
solutions in string form. This time we need an array of string list as dp array, but it’s simpler to use Map in Java.</p>
<p>The basic idea is the same as the version 1, so I won’t repeat here. But it’s not good enough in some special cases. We
need optimizations.</p>
<p>First optimization, we don’t need to verify any substring s[i..j]. We can limit i from j-maxWordLength to j-1.</p>
<p>Second optimization, verify that a string is breakable before calculating the results. </p>
<h2 id="Solution-in-Java"><a href="#Solution-in-Java" class="headerlink" title="Solution in Java"></a>Solution in Java</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> List&lt;<span class="keyword">String</span>&gt; wordBreak(<span class="keyword">String</span> s, Set&lt;<span class="keyword">String</span>&gt; wordDict) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> maxWordLength = <span class="number">0</span>;</div><div class="line">    <span class="built_in">for</span>(<span class="keyword">String</span> <span class="keyword">word</span>: wordDict)&#123;</div><div class="line">        maxWordLength = Math.<span class="built_in">max</span>(maxWordLength, <span class="keyword">word</span>.length());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> n = s.length();</div><div class="line"></div><div class="line">    <span class="built_in">if</span>(n == <span class="number">0</span> || maxWordLength == <span class="number">0</span> || !<span class="built_in">isValid</span>(s, wordDict))&#123;</div><div class="line">        <span class="built_in">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    Map&lt;Integer, List&lt;<span class="keyword">String</span>&gt;&gt; dp = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</div><div class="line">        <span class="built_in">for</span>(<span class="keyword">int</span> i=j<span class="number">-1</span>; i&gt;=j-maxWordLength; i--)&#123;</div><div class="line">            <span class="built_in">if</span>((i==<span class="number">0</span> || dp.<span class="built_in">get</span>(i) != null) &amp;&amp; wordDict.contains(s.substring(i,j)))&#123;</div><div class="line"></div><div class="line">                <span class="comment">// init list</span></div><div class="line">                <span class="built_in">if</span>(dp.<span class="built_in">get</span>(j) == null)&#123;</div><div class="line">                    dp.<span class="built_in">put</span>(j, <span class="keyword">new</span> ArrayList&lt;&gt;());</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">String</span> <span class="keyword">word</span> = s.substring(i, j);</div><div class="line">                <span class="built_in">if</span>(i == <span class="number">0</span>)&#123;</div><div class="line">                    dp.<span class="built_in">get</span>(j).add(<span class="keyword">word</span>);</div><div class="line">                &#125; <span class="built_in">else</span> &#123;</div><div class="line">                    <span class="built_in">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;dp.<span class="built_in">get</span>(i).<span class="built_in">size</span>();k++)&#123;</div><div class="line">                        dp.<span class="built_in">get</span>(j).add(dp.<span class="built_in">get</span>(i).<span class="built_in">get</span>(k) + <span class="string">" "</span> + <span class="keyword">word</span>);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">if</span>(dp.<span class="built_in">get</span>(n) != null)&#123;</div><div class="line">        <span class="built_in">return</span> dp.<span class="built_in">get</span>(n);</div><div class="line">    &#125; <span class="built_in">else</span> &#123;</div><div class="line">        <span class="built_in">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="built_in">isValid</span>(<span class="keyword">String</span> s, Set&lt;<span class="keyword">String</span>&gt; wordDict) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> n = s.length();</div><div class="line">    <span class="keyword">boolean</span>[] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n+<span class="number">1</span>];</div><div class="line"></div><div class="line">    <span class="built_in">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j&lt;=n;j++)&#123;</div><div class="line">        <span class="built_in">for</span>(<span class="keyword">int</span> i=j<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)&#123;</div><div class="line">            <span class="built_in">if</span>((i==<span class="number">0</span> || dp[i]) &amp;&amp; wordDict.contains(s.substring(i,j)))&#123;</div><div class="line">                dp[j] = true;</div><div class="line">                <span class="built_in">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> dp[n];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2015/08/27/Count-Primes/" class="prev">PREV</a><a href="/2015/08/23/Word-Break/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://longweiquan.github.com">Weiquan LONG</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-63462717-1",'auto');ga('send','pageview');</script></body></html>